<!-- DO NOT EDIT THIS FILE-->
<!-- Edit the .tex version instead-->

<html>
<head>
<title>Procedures<a name="g2436"></a></title>
</head>
<body>

<a name="g2437"></a>
<a name="g2438"></a>

<h1>Chapter 5. Procedures<a name="g2439"></a></h1>




<a name="g2441"></a><br>
<b>procedure</b>: <tt>(swl:application-modal <i>application</i> <i>thunk</i>)</tt>
 <br>
<b>returns: </b>see below 
<p>

 <p>
This procedure returns the result of evaluating <i>thunk</i>.
 During the evaluation of <i>thunk</i>, user-interface events
 intended for <i>application</i> are ignored.  This can be used,
 for example, to implement a file-selection dialog that prevents
 the user from manipulating the calling application until the
 dialog is dismissed.  Note that the threads of the application
 are not suspended; its stream of events is merely redirected
 to a bit sink.  See <a href="body_4.html#g2437">5</a>.
<hr><a name="g2442"></a><br>
<b>procedure</b>: <tt>(swl:get-clipboard)</tt>
 <br>
<b>returns: </b>see below 
<p>
 This returns the contents of the clipboard if any, else <tt>#f</tt>.
<hr><a name="g2443"></a><br>
<b>procedure</b>: <tt>(swl:append-clipboard <i>string</i>)</tt>
 <br>
<b>returns: </b>unspecified 
<p>
 This appends the given string to the clipboard where it may be
 retrieved via <tt>(swl:get-selection 'clipboard)</tt>.
 <tt>swl:clear-clipboard</tt> must be called before calling <tt>swl:append-clipboard</tt>,
 and multiple appends should be carried out in a critical section to
 prevent another process from retrieving an incomplete clipboard or
 usurping ownership of the clipboard.
 The append mechanism makes no
 attempt to prevent multiple threads from writing to the clipboard.

 <p>
In practice it appears that each (operating-system) process has its own
 clipboard and <tt>swl:append-clipboard</tt> writes to that clipboard.
 seems to read from the clipboard of whichever process wrote to its
 clipboard last.  <tt>(swl:clear-selection 'clipboard)</tt> seems to
 clear the clipboards of all applications.
 (Still searching for adequate documentation of clipboards in Tcl/Tk.)
<hr><a name="g2444"></a><br>
<b>procedure</b>: <tt>(swl:clear-clipboard)</tt>
 <br>
<b>returns: </b>unspecified 
<p>
 This clears and claims ownership of the clipboard.
<hr><a name="g2445"></a><br>
<b>procedure</b>: <tt>(swl:get-selection)</tt>
 <br>
<b>procedure</b>: <tt>(swl:get-selection <i>selection</i>)</tt>
 <br>
<b>returns: </b>see below 
<p>
 This returns the specified selection (<tt>primary</tt> or <tt>clipboard</tt>)
 as a string if it exists, <tt>#f</tt> otherwise.  The default is to return the
 <tt>primary</tt> selection.
<hr><a name="g2446"></a><br>
<b>procedure</b>: <tt>(swl:clear-selection)</tt>
 <br>
<b>procedure</b>: <tt>(swl:clear-selection <i>selection</i>)</tt>
 <br>
<b>returns: </b>unspecified 
<p>
 This clears the specified selection (<tt>primary</tt> or <tt>clipboard</tt>)
 if it exists.  The default is to clear the <tt>primary</tt> selection.
<hr><a name="g2447"></a><br>
<b>procedure</b>: <tt>(swl:cut-buffer)</tt>
 <br>
<b>procedure</b>: <tt>(swl:cut-buffer <i>text</i>)</tt>
 <br>
<b>returns: </b>see below 
<p>
 This parameter implements a global cut buffer used to emulate the
 behavior of paste in xterm.  When text is selected in a widget for
 which get-export-selection returns true, subsequently clicking the mouse
 saves the current selection in this global cut buffer before clearing
 the selection.  When attempting to paste in a widget, we insert the
 result of <tt>(swl:get-selection 'primary)</tt>, if available, or the
 contents of the cut buffer.
<hr><a name="g2448"></a><br>
<b>procedure</b>: <tt>(swl:font-families)</tt><a name="g2449"></a>
 <br>
<b>procedure</b>: <tt>(swl:font-families constraint)</tt>
 <br>
<b>returns: </b>a list of symbols 
<p>
 Returns a list of symbols naming font families known to the display.
 Items in the returned list are legal values for the <tt>family</tt>
 attribute of <tt>&lt;font&gt;</tt> instances created on the local display.
 If the optional <tt>constraint</tt> is <tt>'fixed</tt>, only the fixed-width
 font families are returned.
<hr><a name="g2450"></a><br>
<b>procedure</b>: <tt>(swl:font-available? family size file)</tt>
 <br>
<b>returns: </b>true if the specified font is available, otherwise false 
<p>
<hr><a name="g2451"></a><br>
<b>procedure</b>: <tt>(swl:application-menu)</tt>
 <br>
<b>returns: </b>an instance of <tt>&lt;cascade-menu-item&gt;</tt>
 <br>
<b>procedure</b>: <tt>(swl:application-menu title thunk)</tt>
 <br>
<b>returns: </b>unspecified 
<p>
 When invoked with no arguments, <tt>swl:application-menu</tt>
 returns a cascade menu item for use as a top level entry
 in the menu of a <tt>&lt;toplevel&gt;</tt> (<i>i.e.</i> supplied as the
 <tt>menu:</tt> attribute of the <tt>&lt;toplevel&gt;</tt> or installed
 via its <tt>set-menu!</tt> method).
 
 <p>
When invoked with two arguments, <tt>swl:application-menu</tt> expects
 <tt>title</tt> to be a valid <tt>&lt;command-menu-item&gt;</tt> title
 (except that images are not allowed due to incompatibilities with
 Windows platforms) and <tt>thunk</tt> to be either a procedure of
 no arguments, to be invoked when this menu item is chosen, or <tt>#f</tt>.
 If <tt>thunk</tt> is a procedure, then existing and future SWL application
 menus will contain an entry with the given title that invokes this
 procedure.  If <tt>thunk</tt> is <tt>#f</tt>, the corresponding menu
 entry (if any) is removed from all SWL application menus.
 Items on the SWL application menu are sorted alphabetically, except
 the last two items:  one titled "Version..." that displays the
 version information on the initial splash screen and one titled
 "Exit SWL" that does what you might expect.
 These default menu entries cannot be removed.
<hr><a name="g2452"></a><br>
<b>procedure</b>: <tt>(swl:help-menu)</tt>
 <br>
<b>returns: </b>an instance of <tt>&lt;cascade-menu-item&gt;</tt>
 <br>
<b>procedure</b>: <tt>(swl:help-menu title thunk)</tt>
 <br>
<b>returns: </b>unspecified 
<p>
 When invoked with no arguments, <tt>swl:help-menu</tt>
 returns a cascade menu item for use as a top level entry
 in the menu of a <tt>&lt;toplevel&gt;</tt> (<i>i.e.</i> supplied as the
 <tt>menu:</tt> attribute of the <tt>&lt;toplevel&gt;</tt> or installed
 via its <tt>set-menu!</tt> method).
 
 <p>
When invoked with two arguments, <tt>swl:help-menu</tt> expects
 <tt>title</tt> to be a valid <tt>&lt;command-menu-item&gt;</tt> title
 (except that images are not allowed due to incompatibilities with
 Windows platforms) and <tt>thunk</tt> to be either a procedure of
 no arguments, to be invoked when this menu item is chosen, or <tt>#f</tt>.
 If <tt>thunk</tt> is a procedure, then existing and future SWL help
 menus will contain an entry with the given title that invokes this
 procedure.  If <tt>thunk</tt> is <tt>#f</tt>, the corresponding menu
 entry (if any) is removed from all SWL help menus.
 Items on the SWL help menu are sorted alphabetically, except that the
 last item is always a "Documentation" button that displays the
 online documentation.
 The default menu entry cannot be removed.
<hr><a name="g2453"></a><br>
<b>procedure</b>: <tt>(swl:begin-application <i>start-k</i>)</tt><a name="g2454"></a>
 <br>
<b>returns: </b>unspecified 
<p>
 Installs a new fallback queue and service thread and
 calls <tt>start-k</tt> to construct the application.
 <tt>start-k</tt> is passed a unique application token
 that may be supplied to <tt>swl:end-application</tt>
 in order to remove the applicaiton from the list of
 registered applications.
 SWL exits when the last registered application is removed.
 The <tt>start-k</tt> is expected to return an exit-notify
 thunk.
 The exit-notify thunk is invoked when the user clicks on
 the SWL "Exit SWL" button and by the default
 <tt>abort-handler</tt>.

 <p>
Widgets created during the evaluation of <tt>start-k</tt>
 share the new fallback event queue.
 Because events must be processed serially,
 using a single event queue for all applications
 would allow one ill-behaved application to
 prevent other applications in the Scheme session
 from receiving events.
<hr><a name="g2455"></a><br>
<b>procedure</b>: <tt>(swl:end-application <i>token</i>)</tt>
 <br>
<b>returns: </b>unspecified 
<p>
 Remove from the list
 of active applications the instance granted this
 token and invoke the exit thunk supplied at that
 time (see <a href="body_4.html#g2437">5</a>).
 If <i>token</i> is the symbol <tt>exit-all</tt>, invoke the
 remaining exit thunks and exit SWL if no protected
 applications remain.
<hr><a name="g2456"></a><br>
<b>procedure</b>: <tt>(swl:open-tcp-client <i>hostname</i> <i>port-number</i> <i>async?)</i></tt>
 <br>
<b>returns: </b>an input-output port 
<p>
 Returns an input/output port connected by a socket
 to the specified port number on the given host.
 If the async flag is true, the socket is connected asynchronously, i.e.,
 the port object is returned without waiting for the actual connection
 to be made.
<hr><a name="g2457"></a><br>
<b>procedure</b>: <tt>(swl:open-tcp-server <i>host</i> <i>port</i> <i>handler</i>)</tt>
 <br>
<b>returns: </b>an input-output port 
<p>
 Creates a server socket for the given <i>port</i>.  <i>host</i> specifies
 a fully qualified domain name or numerical IP address of the
 network interface to use for the connection.  If <i>host</i> is <tt>#f</tt>
 then the server accepts connections via any interface.
 When a connection is made, <i>handler</i> is passed three arguments:
 an input/output port connected to the client via socket, the hostname
 of the client and the port number for the client.
 <tt>swl:open-tcp-server</tt> returns a port that cannot be read from or
 written to, but which can be closed to terminate the server.
<hr><a name="g2458"></a><br>
<b>procedure</b>: <tt>(swl:font-dialog parent title families sizes styles current-font new-font cleanup)</tt>
 <br>
<b>returns: </b>See below 
<p>
 This procedure displays a font dialog
 for the given <tt>parent</tt> (an instance of <tt>&lt;toplevel&gt;</tt> or <tt>#f</tt>, if none).
 SWL attempts to place the dialog centered above the parent, if given, or
 centered on the screen.
 The <tt>title</tt> is used as the title of the toplevel window that is
 created.
 The <tt>families</tt>, <tt>sizes</tt>, and <tt>styles</tt> parameters are
 lists of values appropriate for creating instances of the <tt>&lt;font&gt;</tt>
 class.
 The <tt>current-font</tt> procedure is invoked with no arguments, and should
 return an instance of <tt>&lt;font&gt;</tt> used to supply default values for the
 widgets displaying the various options.
 When the "OK" button is pressed, the <tt>new-font</tt> procedure is invoked
 with an instance of the selected font.
 When the "Cancel" button is pressed, <tt>new-font</tt> is invoked with <tt>#f</tt>.
<hr><a name="g2459"></a><br>
<b>procedure</b>: <tt>(swl:screen-height)</tt>
 <br>
<b>returns: </b>height of the screen, in pixels 
<p>

 <p>
This procedure returns height of the screen in pixels.
<hr><a name="g2460"></a><br>
<b>procedure</b>: <tt>(swl:screen-width)</tt>
 <br>
<b>returns: </b>width of the screen, in pixels 
<p>

 <p>
This procedure returns width of the screen in pixels.
<hr><a name="g2461"></a><br>
<b>procedure</b>: <tt>(swl:sync-display)</tt>
 <br>
<b>returns: </b>unspecified 
<p>
 Because display updates are buffered by Tcl/Tk, the application
 state can be out of sync with the display.
 While this is normally invisible,
 <tt>swl:sync-display</tt> can be used to flush pending display
 updates to the screen in cases where it would otherwise be noticed.
 It is often necessary to flushing display before getting the width or
 height of a widget that has just been created, because Tk
 defers geometry calculations until rendering the widget.


<p>



</body>
</html>
